# 3. データの読み込み

本セクションでは、画像処理のための入力データを読み込む処理について説明する。

## ディレクトリ構成

処理対象となる画像データは以下のような構造で格納されている：

```
data/
├── input/
│   ├── NG/
│   │   └── label1/  # 鋳巣の画像
│   │       ├── ***Shape***.jpg
│   │       └── ...      
│   ├── OK/
│   │   ├── No1/  # 正常品（50ワーク分）
│   │   │   ├── ***Shape***.jpg
│   │   │   └── ...
│   │   ├── No2/
│   │   └── ...  # No20まで
│   ├── left_right_judge_template/
│   │   ├── left_template.jpg
│   │   └── right_template.jpg
│   └── mask_template/
       ├── left_template.jpg
       └── right_template.jpg
```

## 関数の説明

### load_shape_images()

指定されたディレクトリから検査対象となるワークの画像（Shape画像）を読み込む関数である。以下の特徴を持つ：

1. ディレクトリの再帰的走査
   - os.walkを使用してサブディレクトリも含めて探索
   - "Shape"を含むjpg形式のファイルのみを抽出

2. 戻り値の形式
   - (画像の完全パス, ファイル名)のタプルをリストとして返却
   - パスは後続の画像読み込みに使用
   - ファイル名はデバッグや結果の可視化に使用

### load_template_images()

ワークの左右判定用とマスク生成用のテンプレート画像を読み込む関数である。以下の処理を行う：

1. 左右判定用テンプレート
   - 左側用と右側用の2種類のテンプレートを読み込む
   - グレースケールで読み込み（cv2.IMREAD_GRAYSCALE）

2. マスク用テンプレート
   - 左側用と右側用の2種類のテンプレートを読み込む
   - グレースケールで読み込み

3. 戻り値の形式
   - judge_templates: 左右判定用テンプレート
   - mask_templates: マスク用テンプレート
   - 各テンプレートは{'left': image, 'right': image}の辞書形式

### visualize_loaded_images()

読み込んだ画像を可視化する関数である。デバッグや画像の確認に使用する。

1. 表示内容
   - Shape画像のサンプル
   - 左右判定用テンプレート（左右）
   - マスク用テンプレート（左右）

2. 表示形式
   - Shape画像: 個別のプロット
   - テンプレート画像: 2x2のサブプロット

## 重要な注意点

1. メモリ使用量の考慮
   - OK画像は50ワークごとにNo1~No20のディレクトリに分割されている
   - メモリ不足を防ぐため、一度に全ディレクトリを処理せず、必要なディレクトリのみを指定して処理する
   - ok_labelsパラメータで処理対象のディレクトリを指定（例: 'No1'）

2. 画像の前処理
   - すべての画像はグレースケールとして読み込まれる
   - これにより処理の一貫性を保ち、メモリ使用量も抑制
