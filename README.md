# 7. 欠陥候補のフィルタリング

## 目的
エッジ処理後の欠陥候補に対して、サイズや形状に基づくフィルタリングを行い、各欠陥の特徴量を計測する。これにより、真の欠陥と誤検出を区別するための定量的な情報を得る。

## 処理手順
1. エッジ処理結果の二値化
2. 連結成分のラベリング
3. サイズによるフィルタリング
4. 特徴量の計測
5. 結果の可視化

## 関数の詳細説明

### measure_region_properties()
欠陥候補領域の特徴量を計測する関数：

1. 基本情報
   - 位置：x, y（左上座標）
   - サイズ：width, height, area
   - 中心：centroid_x, centroid_y

2. 形状特徴量
   - perimeter：周囲長
   - eccentricity：離心率
   - orientation：主軸の方向
   - major/minor_axis_length：長軸/短軸長
   - solidity：充実度
   - extent：矩形度

3. 計算特徴量
   - aspect_ratio：縦横比
   - max_length：最大辺長
   - detection_method：検出手法

### process_defect_regions()
指定サイズ範囲の欠陥候補を処理する関数：

1. 処理内容
   - 連結成分のラベリング
   - サイズによるフィルタリング
   - 特徴量の計測
   - ラベル番号の付与

2. フィルタリング条件
   - min_size ≤ area ≤ max_size
   - 検出手法別の条件適用

### filter_defects()
Canny検出とDoG検出の結果をフィルタリングする関数：

1. 前処理
   - マスクエッジの生成
   - 二値化処理
   - エッジ部分の除外

2. 処理分岐
   - 大きな欠陥：Canny検出結果
   - 小さな欠陥：DoG検出結果

### process_images_for_filtering()
画像群に対してフィルタリングを実行する関数：

1. 入力データ
   - マスク画像
   - Canny検出結果
   - DoG検出結果

2. 出力データ
   - マスク
   - フィルタリング後の欠陥情報
   - 元のファイル名

### visualize_filtered_defects()
フィルタリング結果を可視化する関数：

1. 表示内容
   - 左：ラベルなし結果
   - 右：ラベル付き結果

2. 色分け表示
   - グレー：加工領域
   - 赤：Canny検出結果
   - 青：DoG検出結果

これらの処理により、欠陥候補の定量的な評価が可能となり、後続の分類処理のための基礎データが得られる。
