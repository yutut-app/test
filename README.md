スライド1: サマリー
「今日は、鋳造の鋳巣検知における2つの課題について、その解決策を提案します。大きな鋳巣の測定精度向上と、隣接する鋳巣の正確な判定が主な課題です。これらを解決するため、3つの画像処理手法を提案します。」

スライド2: 現状の課題
「現在、小さい鋳巣は正確に測れるのですが、大きい鋳巣になると精度が落ちてしまいます。また、隣接する鋳巣を別々のものとして判断してしまう問題があります。これらを解決し、全ての大きさの鋳巣を正確に測り、隣接する鋳巣も正しく判断できるような画像処理手法の提案をしたいと考えています。」

スライド3: 現状の処理手順
「現在の処理手法について、認識の齟齬がないかを確認させていただきたいと思います。現状の手順の問題点として、手順4,5において、大小の鋳巣に対応困難、手順5において、クロージング処理では隣接鋳巣の正確な判定が困難という点があります。」

スライド4: ガウシアンフィルタ (1/2)
「ガウシアンフィルタは、現在の手順4の平均化処理を改良するものです。主に大きい鋳巣の測定精度向上を目指しています。この図では、平均化フィルタとガウシアンフィルタの処理後の画像比較、そしてガウシアンフィルタの重み付けを示しています。平均化フィルタでは全ての画素を均等に扱いますが、ガウシアンフィルタでは、注目している画素とその周辺の画素で重みに差をつけます。具体的には、注目している画素自体の値を最も重視し、そこから離れるほど影響を小さくします。これは、人間の目が物を見るときの仕組みに似ています。近くのものをはっきり見て、遠くのものをぼんやり見るような感覚です。この方法により、鋳巣の形状をより自然に、人間の目で見たように再現できる可能性があります。」

スライド5: ガウシアンフィルタ (2/2)
「ガウシアンフィルタの特徴である重み付けにより、いくつかのメリットとデメリットが生じます。メリットとしては、大きい鋳巣の形状をより正確に捉えられる可能性があります。これは、注目している画素の値を大切にしながら、周りの情報も少し取り入れるので、急激な変化を抑えつつ、元の形状を保持できるからです。また、ノイズ除去効果も高くなります。突然現れる小さなノイズは、周囲の値によって自然に抑えられるためです。一方、デメリットとしては、処理時間が増加します。これは、各画素で複雑な計算が必要になるためです。また、小さい鋳巣の検出感度が低下する可能性があります。小さい鋳巣全体が、影響の小さい周辺部分に入ってしまう可能性があるためです。」

スライド6: メディアンフィルタ (1/2)
「メディアンフィルタは、現在の手順4の平均化処理を改良するもので、主に大きい鋳巣の測定精度向上を目指しています。この図では、平均化フィルタとメディアンフィルタの処理後の画像比較を示しています。平均化フィルタが全ての値の平均を取るのに対し、メディアンフィルタは値を順番に並べて真ん中の値を選びます。例えば、80,128,150,64,160,255,64,190,200 という9つの値があれば、並べ替えて 80,128,150,64,160,255,64,190,200とし、150を選びます。これにより、極端に大きな値や小さな値（ノイズ）の影響を受けにくくなります。ただし、メディアンフィルタには重み付けの概念はありません。代わりに、注目画素の周辺の値を全て平等に扱い、その中から代表値を選ぶという特徴があります。」

スライド7: メディアンフィルタ (2/2)
「メディアンフィルタの特徴により、いくつかのメリットとデメリットが生じます。メリットとしては、ノイズに非常に強く、鋳巣の境界をよく保持できることです。これは、極端な値（ノイズ）を自動的に除外するためです。例えば、鋳巣の境界では値が急激に変化しますが、メディアンフィルタはこの変化を保持します。なぜなら、境界付近では高い値と低い値が混在し、その中間の値（境界の値）が選ばれやすいからです。特に大きい鋳巣の測定に効果的です。一方、デメリットとしては、処理時間が増加します。これは、各画素の周辺の値を並べ替える必要があるためです。また、非常に小さい鋳巣の検出が難しくなる可能性があります。小さい鋳巣全体が、周辺の正常な値に埋もれてしまう可能性があるためです。平均化フィルタと比べると、メディアンフィルタは極端な値の影響を受けにくい処理が可能ですが、細かい特徴を失う可能性も高くなります。」

スライド8: フィルタと鋳巣測定精度
「ここでは、3つのフィルタの特性を鋳巣測定の観点から比較します。全て小さい鋳巣用の窓サイズ（151x151ピクセル）を前提としています。現状の平均化フィルタを基準に説明します。
平均化フィルタは小さい鋳巣の長さ測定に適していますが、大きい鋳巣の測定精度が低下します。また、深さの極値が失われる可能性があります。これは、平均化フィルタが周囲の全てのピクセル値を均等に扱うため、深い部分（極値）の値が周囲の浅い部分の値と平均化されてしまうからです。例えば、非常に深い点があっても、周囲の浅い部分と平均を取ることで、その深さが薄められてしまいます。
ガウシアンフィルタは、大きい鋳巣の長さ測定精度が向上し、深さ情報をある程度保持できます。ただし、小さい鋳巣の検出がやや困難になる可能性があります。
メディアンフィルタは、大きい鋳巣の長さ測定に最も適しており、深さの極値を最も正確に保持できる可能性があります。ただし、小さい鋳巣の検出が困難になる可能性があります。
各フィルタにはそれぞれ長所と短所があり、用途に応じて適切なものを選ぶ必要があります。」

スライド9: フィルタ比較
「この表は、各フィルタの特性を比較したものです。平均化フィルタを基準としています。
ガウシアンフィルタとメディアンフィルタは、平均化フィルタと比べてノイズ除去やエッジ保持の面で優れています。特にメディアンフィルタはこれらの面で最も効果的です。
鋳巣長さ（大）と鋳巣深さの測定精度は、平均化フィルタよりガウシアンフィルタの方が向上し、さらにメディアンフィルタが最も優れています。これは、ガウシアンフィルタが中心部分を重視し、メディアンフィルタが極端な値を除外する特性によるものです。
一方で、処理速度は平均化フィルタが最も速く、ガウシアンフィルタ、メディアンフィルタの順に遅くなります。これは、計算の複雑さが増すためです。
したがって、鋳巣測定の精度と処理速度はトレードオフの関係にあります。実際の適用では、要求される精度と許容できる処理時間のバランスを考慮してフィルタを選択することを提案します。」

スライド10: マルチスケール処理 (1/2)
「マルチスケール処理は、現状の手順4の平均化処理を拡張する方法です。主に課題①、つまり大小の鋳巣を同時に正確に測定することを目指しています。
この方法では、異なる大きさの窓サイズで処理を複数回行います。例えば、小さい鋳巣用(151x151ピクセル)、中間サイズ用(301x301ピクセル)、大きい鋳巣用(501x501ピクセル)の3つの窓サイズで処理を行います。
画像全体に対して全ての窓サイズの処理を適用し、各ピクセルに対して3つの異なる窓サイズでの処理結果が得られます。これらの結果を統合する方法としては、以下のようなアプローチが考えられます：
最大値採用：各ピクセルで、3つの結果の中で最も大きな（深い）値を鋳巣の深さとして採用します。鋳巣の長さは、この最大値を持つ領域の最大径とします。
重み付け平均：3つの結果に対して重み付けをして平均を取ります。例えば、(小さい窓の結果 x 0.2 + 中間窓の結果 x 0.3 + 大きい窓の結果 x 0.5) / 3 のように計算し、この値を鋳巣の深さとします。鋳巣の長さは、この平均値が一定以上の領域の最大径とします。
これらの方法により、異なる大きさの鋳巣に対して適切に対応できる可能性があります。具体的な統合方法や閾値は、鋳造品の特性や求められる精度によって最適なものを選択・調整する必要があります。」

スライド11: マルチスケール処理 (2/2)
「提案するウィンドウサイズの例として、小さい鋳巣用(0.3mm)に151x151ピクセル、中間サイズ用(0.6mm)に301x301ピクセル、大きい鋳巣用(1.0mm)に501x501ピクセルを挙げています。しかし、これはあくまで例です。実際の適用では、検出したい鋳巣のサイズに応じて、2つのサイズだけを使用したり、さらに細かく分けたりすることも可能です。
この方法のメリットは、様々な大きさの鋳巣を同時に検出・測定できる点です。大きい鋳巣の測定精度向上と小さい鋳巣の検出精度維持を両立できる可能性があります。
一方で、デメリットとしては処理時間とメモリ使用量の大幅な増加があります。これは、複数の窓サイズで処理を繰り返すためです。また、異なるスケールの結果をどのように統合するかという実装面での複雑さも増します。
したがって、この方法を採用する際は、得られる精度の向上と増加する計算コストのバランスを十分に検討する必要があります。場合によっては、処理時間や使用可能なメモリ量に制約がある場合、一部の窓サイズのみを使用するなど、柔軟な対応が求められます。」

スライド12: 次回の予告
「今回提案した方法以外にも、まだ検討中の手法があります。今回は提案していない、隣接している鋳巣の判定をより正確にする方法や、処理をより効率的にする方法を考えています。次回、これらについてご提案させていただきたいと思います。」
