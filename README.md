# 2. パラメータの設定（追加分）

### 二値化パラメータ
`binary_threshold`：
- 画像の二値化閾値（0-255）
- 加工領域とそれ以外を分離する基準値
- 大きいほど白い領域（1）が減少
- 調整範囲：120~160
- デフォルト値：128

# 4. 加工領域の特定

本セクションでは、ワークの加工領域をマスク画像として特定する処理について説明する。処理は以下の手順で実行される：

1. 撮影方向の判定
2. マスクテンプレートの選択と位置合わせ
3. マスク画像の生成

## 関数の詳細説明

### determine_image_orientation()
画像の撮影方向（左右）を判定する関数：

1. 判定手法
   - テンプレートマッチング（cv2.TM_CCOEFF_NORMED）を使用
   - 左右それぞれのテンプレートとのマッチング度を計算
   - より高いマッチング度を示した方を撮影方向として判定

2. 入力データ
   - 入力画像：Normal画像（グレースケール）
   - 判定テンプレート：左右それぞれのテンプレート画像

3. 出力
   - 'left'：左側からの撮影画像
   - 'right'：右側からの撮影画像

### create_processing_area_mask()
加工領域のマスクを生成する関数：

1. 前処理
   - 画像の二値化（binary_threshold使用）
   - 撮影方向の判定
   - 適切なマスクテンプレートの選択

2. 位置合わせ処理
   - 画像とテンプレートをfloat32型に変換
   - 位相限定相関によるズレ計算
   - アフィン変換行列の生成
   - テンプレートの移動

3. エラー処理
   - 処理失敗時は全領域を対象とするマスクを返却

### process_images()
画像群に対して一括で加工領域の検出を行う関数：

1. 入力データの処理
   - Shape1画像とNormal画像のパス生成
   - 画像の読み込みと存在確認
   - グレースケール変換

2. マスク生成処理
   - 画像の二値化
   - 撮影方向の判定
   - 位相限定相関によるズレ計算
   - マスク画像の生成

3. 出力データ
   - processed_images：処理結果のリスト
   - shifts：各画像のシフト量

### visualize_processed_images()
処理結果を可視化する関数：

1. 表示内容（2×2レイアウト）
   - 二値化したNormal画像
   - 移動前のテンプレート画像
   - 移動後のテンプレート画像（シフト量を表示）
   - 最終的なマスク画像

2. 表示パラメータ
   - figsize=(12, 12)で十分な表示サイズを確保
   - グレースケールカラーマップを使用
   - 軸表示を省略してクリーンな表示

これらの処理により、加工領域を正確に特定し、後続の欠陥検出処理のための準備が完了する。
