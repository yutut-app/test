# 3. データの読み込み

本セクションでは、キーエンスカメラで撮影した画像データの読み込みと可視化について説明する。

## データ構造

1. 画像の種類
   - Normal画像：キーエンス処理前の撮影画像
   - Shape画像：キーエンス処理後の画像
   - 同一ワークに対してNormalとShapeの2種類が存在

2. ディレクトリ構成
   ```
   data/
   ├── input/
   │   ├── NG/
   │   │   └── label1/  # 鋳巣の画像
   │   │       ├── ***Normal***.jpg
   │   │       ├── ***Shape***.jpg
   │   │       └── ...
   │   └── OK/
   │       ├── No1/     # 正常品（50ワーク分）
   │       │   ├── ***Normal***.jpg
   │       │   ├── ***Shape***.jpg
   │       │   └── ...
   │       └── ...      # No20まで存在
   ```

## 関数の詳細説明

### load_origin_keyence_images()
画像ペアを読み込む関数：

1. 画像の検索処理
   - ディレクトリの再帰的走査
   - Normal/Shape画像の識別
   - JPG形式のみを対象

2. ペアリング処理
   - Normal/Shapeの文字列を除いた共通部分で対応付け
   - 両方が存在する画像のみを抽出
   - タプル形式で保持（Normalパス、Shapeパス、ファイル名）

3. 戻り値の形式
   ```python
   [
       (normal_path_1, shape_path_1, filename_1),
       (normal_path_2, shape_path_2, filename_2),
       ...
   ]
   ```

### visualize_image_pair()
画像ペアを可視化する関数：

1. 表示内容
   - Normal画像とShape画像を横に並べて表示
   - グレースケールで表示
   - タイトルと軸の設定

2. 表示パラメータ
   - figsize=(15, 7)で十分な表示サイズを確保
   - 2画像を1行に配置
   - tight_layoutで自動レイアウト調整

## 重要な注意点

1. メモリ使用量の考慮
   - OK画像は50ワークごとにNo1~No20のディレクトリに分割
   - メモリ不足を防ぐため、必要なディレクトリのみを処理

2. エラー処理
   - 存在しない画像ペアの検出
   - 読み込み失敗時のハンドリング
   - インデックス範囲のチェック

3. 画像の対応付け
   - ファイル名の共通部分で厳密にペアリング
   - 片方のみ存在する画像は除外

これらの処理により、後続の処理で必要となる画像ペアを適切に読み込むことができる。
