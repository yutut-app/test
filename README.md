# 6. Canny+DoGによる欠陥検出

このセクションでは、大きな鋳巣と小さな鋳巣を効果的に検出するため、2つの異なる手法を組み合わせています。

1. `detect_edges_and_texture`関数（大きな鋳巣の検出）
  - 目的：大きな鋳巣（10ピクセル以上）を検出する
  - 処理の流れ：
    * マスク領域内の画像抽出：検査対象領域のみを取り出す
    * 明暗領域の直接検出：輝度値に基づいて明るい部分と暗い部分を抽出
    * Cannyエッジ検出：輝度の急激な変化（エッジ）を検出
    * テクスチャ検出：表面の細かい凹凸（テクスチャ）を検出
    * 勾配強度の計算：輝度変化の強さを計算
    * 結果の統合：各検出結果を組み合わせて最終的な検出結果を生成

2. `detect_defects_dog_dynamic`関数（小さな鋳巣の検出）
  - 目的：小さな鋳巣（5〜10ピクセル）を検出する
  - 処理の流れ：
    * マルチスケールDoG適用：異なる強度のぼかしの差分を取り、様々なサイズの特徴を検出
    * 動的閾値処理：局所的な輝度変化に基づいて二値化
    * 輝度変化率計算：周囲との輝度差を計算
    * コントラスト比計算：局所的なコントラストを評価
    * 結果の統合：各処理結果を組み合わせて最終的な検出結果を生成

3. `combine_defect_detection`関数（検出結果の統合）
  - 目的：CannyとDoGの検出結果を統合し、総合的な欠陥検出を行う
  - 処理内容：
    * 両手法の検出結果を取得
    * 各手法の特徴を活かした結果を保持
    * 最終的な検出結果を生成

4. その他のユーティリティ関数
  - `difference_of_gaussian`：2つの異なるガウシアンフィルタの差分を計算
  - `dynamic_threshold`：局所的な特徴に基づいて閾値を動的に決定
  - `process_images_for_defect_detection`：画像群に対して一括で欠陥検出を実行

次のセクションのmarkdownを続けて作成しましょうか？
