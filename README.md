承知しました。No1_Detecting_defect_candidates.ipybの#3データの読み込みについて、詳細なmarkdownを作成します。

# 3. データの読み込み

本セクションでは、KeyenceマイクロスコープでワークOK/NGを撮影した画像データの読み込み処理について説明します。

## ディレクトリ構成

入力データは以下のような構造で保存されている必要があります：

```
input_data_dir/
├── NG/
│   └── label1/               # 鋳巣(欠陥)の画像ディレクトリ
│       ├── xxxNormal.jpg     # 通常観察画像
│       └── xxxShape.jpg      # 形状強調画像
└── OK/
    ├── No1/                  # OK画像 バッチ1 (50ワーク分)
    │   ├── xxxNormal.jpg
    │   └── xxxShape.jpg
    ├── No2/                  # OK画像 バッチ2 (50ワーク分)
    │   ├── xxxNormal.jpg
    │   └── xxxShape.jpg
    ...
    └── No20/                 # OK画像 バッチ20
```

## 画像の種類

Keyenceマイクロスコープでは、各ワークに対して2種類の画像を撮影します：

1. Normal画像（通常観察画像）
   - 接触式照明による通常の観察画像
   - ワークの全体的な形状や表面状態を確認可能

2. Shape画像（形状強調画像）
   - 同軸落射照明による形状強調画像
   - 表面の凹凸や微細な形状変化を強調して表示

## 画像読み込み関数の詳細

`load_origin_keyence_images`関数は以下の処理を行います：

1. 指定されたディレクトリ内を再帰的に走査し、NormalとShape画像を検索
2. ファイル名から"Normal"/"Shape"を除いた部分をキーとして、画像パスを辞書に格納
3. NormalとShapeの画像ペアを作成し、タプルのリストとして返却

### 引数
- `directory (str)`: 画像が格納されているディレクトリのパス

### 戻り値
- `list`: (Normal画像パス, Shape画像パス, Shape画像ファイル名)のタプルのリスト

## 可視化関数の詳細

`visualize_loaded_images`関数は読み込んだ画像ペアを可視化します：

1. 指定されたサンプル数分の画像ペアを表示
2. 各ペアについて、NormalとShape画像を横に並べて表示
3. グレースケールで表示し、画像の特徴を確認可能

### 引数
- `image_pairs (list)`: 画像ペアのリスト
- `num_samples (int)`: 表示するサンプル数（デフォルト: 1）

## 重要な注意点

1. メモリ管理：
   - OKワークの画像は大量（1000ワーク以上）になるため、全データの同時読み込みは避ける
   - 50ワークごとにNo1~No20のディレクトリに分割して処理
   - コード実行時は手動でディレクトリ（No1~No20）を指定する必要あり

2. 画像ペアの整合性：
   - NormalとShape画像は必ず対応するペアが存在する必要あり
   - ペアが欠けている場合は自動的にスキップ

3. 画像フォーマット：
   - JPG形式のみ対応
   - ファイル名に"Normal"または"Shape"を含む必要あり

これらの関数を用いて、後続の処理で使用する画像データを適切に読み込むことができます。
