調査すべき事項について、以下のポイントに沿って詳細を調査し、結果を報告します。

### 1. 前処理における画像切り出しの自動化
**調査結果**：
前処理でワーク（対象物）部分のみを自動で切り出すには、物体の位置や形状を特定する必要があります。一般的には、物体検出技術が使われます。具体的なアプローチとしては以下が有効です。

- **背景除去**: ワークが撮影された背景やつなぎ目を除去するため、背景差分法や、物体の形状に基づいたマスキング技術（GrabCutアルゴリズム）が使用されます。GrabCutは、ユーザーが指定した初期領域を元に前景（ワーク）と背景を分離します。
  
- **エッジ検出**: Cannyエッジ検出器やSobelフィルターは、物体の輪郭を検出するのに適しています。これにより、ワークの境界を特定し、その領域を切り出せます。

**おすすめツール**：
- OpenCV: 背景差分法やエッジ検出が簡単に実装できるライブラリ。

### 2. 欠陥分類のためのフィルタリング手法
**調査結果**：
ツールマーク、水滴、鋳巣のフィルタリングには、以下の特徴量に基づいた分類が有効です。

- **形状特徴量**: 欠陥の形状に基づく特徴量を抽出します。形状の凸包や輪郭の面積、周囲の長さの比率、円形度などを用いて、異なる欠陥を分類できます。特にツールマークや水滴は、形状的に特徴的なパターンを持つことが多いため、これらの特徴量を用いて分類できます。

- **テクスチャ特徴量**: 水滴やツールマークのように、表面のテクスチャの違いを捉えるため、局所バイナリパターン（LBP）やヒストグラム・オブ・オリエンテッド・グラディエント（HOG）などのテクスチャ特徴量を用いることができます。

- **大きさによるフィルタリング**: φ0.5mm以下の鋳巣を除外するためには、サイズに基づいたフィルタリングを行います。具体的には、欠陥の面積を計算し、一定の面積以下のものを自動で除外するように設定できます。

**おすすめツール**：
- OpenCV: 輪郭の抽出、特徴量計算（面積や長さなど）をサポート。
- skimage（Pythonライブラリ）: テクスチャ解析に適しており、LBPやHOGが利用可能。

### 3. 小さな欠陥の除外と検出の最適化
**調査結果**：
特に小さな欠陥（φ0.5mm以下）を除外しつつ、φ0.5mm以上の鋳巣を正確に検出するには、以下の最適化方法があります。

- **欠陥のスケールに応じたフィルタリング**: 画像のスケールを調整し、異なるサイズの欠陥を別々に検出する手法が有効です。マルチスケール分析により、各スケールごとに欠陥のサイズを測定し、特定のサイズ以下の欠陥を除外することができます。

- **モルフォロジー変換**: 膨張や収縮といったモルフォロジー変換を用いて、欠陥の大きさに応じたフィルタリングを行い、小さな欠陥の除去を実現します。

**おすすめツール**：
- OpenCV: モルフォロジー変換のサポートあり。
- scikit-image: 画像のスケール変換やモルフォロジー操作に対応。

### 4. データ不足への対応
**調査結果**：
NGデータが3枚しかないため、データ不足の問題に対しては、データ拡張とFew-shot Learningが有効です。

- **データ拡張**: 欠陥データを増やすために、画像の回転、反転、ズーム、ノイズ追加などのデータ拡張技術を用います。これにより、少ないデータでも多様なパターンを学習できます。

- **Few-shot Learning**: 既存のモデルに少量のデータで学習させるFew-shot Learningの技術が有効です。特に、メタラーニングを用いることで、新しい欠陥パターンに対する認識能力を向上させることができます。

**おすすめツール**：
- TensorFlowやPyTorchでFew-shot Learningモデルを構築可能。
- Augmentor: Pythonで簡単にデータ拡張を行うためのライブラリ。

---

これらの調査結果を基に、鋳巣以外の欠陥を除外しつつ、NG鋳巣のみを検出するためのモデル構築を進めることができます。
