#3のデータ読み込み部分に関するmarkdownを作成する。

# 3. データの読み込み

## 3.1 ディレクトリ構成
以下のようなディレクトリ構造を前提としている：

```
data/
├── input/
│   ├── NG/
│   │   └── label1/  # 鋳巣の画像が格納されているディレクトリ
│   │       ├── ワーク1/
│   │       │   ├── Shape_001.jpg
│   │       │   └── ...
│   │       └── ...
│   ├── OK/
│   │   ├── No1/  # 正常品の画像（50ワーク分）
│   │   │   ├── ワーク1/
│   │   │   │   ├── Shape_001.jpg
│   │   │   │   └── ...
│   │   │   └── ...
│   │   ├── No2/
│   │   └── ...  # No20まで存在
│   ├── left_right_judge_template/
│   │   ├── left_template.jpg
│   │   └── right_template.jpg
│   └── mask_template/
│       ├── left_template.jpg
│       └── right_template.jpg
└── output/  # 処理結果の出力先
```

## 3.2 画像読み込み関数の説明

### load_shape_images関数
指定されたディレクトリから検査対象のShape画像を再帰的に読み込む関数である。

**処理内容：**
1. 指定ディレクトリ以下を再帰的に走査
2. ファイル名に"Shape"が含まれ、拡張子が".jpg"のファイルを抽出
3. 画像パスとファイル名のタプルのリストを返却

### load_template_images関数
左右判定用とマスク用のテンプレート画像を読み込む関数である。

**処理内容：**
1. 左右判定用テンプレート画像の読み込み
   - 左側用テンプレート（left_judge_template_path）
   - 右側用テンプレート（right_judge_template_path）
2. マスク用テンプレート画像の読み込み
   - 左側用マスク（left_mask_template_path）
   - 右側用マスク（right_mask_template_path）
3. グレースケールで読み込んだ画像を辞書形式で返却

## 3.3 画像読み込みの実行
NGとOKの画像、およびテンプレート画像を読み込む。

**重要な注意点：**
- OK画像（No1～No20）は50ワークごとに分割されており、メモリ制約のため一度に全てを読み込むことは推奨されない
- 実行時は必要なディレクトリ（例：No1）のみを指定して読み込むことが推奨される
- コード中の`ok_images`の読み込み部分はコメントアウトされており、必要に応じて手動でパスを指定する

## 3.4 可視化関数（visualize_loaded_images）
読み込んだ画像を視覚的に確認するための補助関数である。

**表示内容：**
1. Shape画像のサンプル
   - グレースケールで表示
   - ファイル名をタイトルとして表示
2. テンプレート画像
   - 左右判定用テンプレート（左右）
   - マスク用テンプレート（左右）

**使用方法：**
- `num_samples`パラメータで表示するShape画像の数を制御可能
- デフォルトでは各カテゴリから1枚のサンプルを表示
