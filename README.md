# 時系列データの分析準備

このセクションでは、鋳造プロセスの時系列データを分析するための準備を行います。こ

## なぜこの準備が重要か？

1. **データの整理**: 
   適切なデータ形式に変換することで、後の分析がスムーズに行えます。

2. **分析対象の明確化**: 
   鋳造条件に関連する列を特定することで、分析の焦点を絞ることができます。

3. **視覚化の準備**: 
   品番ごとに色を固定することで、グラフの一貫性と読みやすさが向上します。

4. **結果の保存準備**: 
   出力ディレクトリを設定することで、分析結果を整理して保存できます。

## コードの説明

```python
import pandas as pd
import os
from datetime import datetime

# データの読み込みと前処理
df = pd.read_csv('casting_data.csv')
df['日時'] = pd.to_datetime(df['日時'])
df['日付'] = df['日時'].dt.date

# 鋳造条件の列名を取得（int型とfloat型の列）
casting_condition_columns = df.select_dtypes(include=['int64', 'float64']).columns.tolist()
casting_condition_columns = [col for col in casting_condition_columns if col != '目的変数']

# 出力ディレクトリの作成
output_dir = r'..\data\output\eda\NG数の時系列の偏り'
os.makedirs(output_dir, exist_ok=True)

# 品番ごとの固定色を定義
color_map = {
    2: 'red',
    4: 'blue',
    5: 'green',
    6: 'purple'
}
```

このコードは以下の準備を行います：

1. データを読み込み、日時と日付の列を適切な形式に変換します。
2. 鋳造条件に関連する列（数値データ）を特定します。
3. 分析結果を保存するためのディレクトリを作成します。
4. 各品番に固定の色を割り当てます。

これらの準備により、時系列でのNG率の変動や、鋳造条件と品質の関係を効果的に分析できるようになります。例えば、特定の日や時間帯でNG率が高くなる傾向があるか、あるいは特定の鋳造条件がNG率に影響を与えているかなどを調査することができます。

次のステップでは、これらの準備に基づいて実際のデータ分析と可視化を行います。時間帯別、日別、週別などさまざまな時間スケールでNG率を分析することで、品質管理の改善につながる洞察を得ることができるでしょう。
