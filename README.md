# 前処理の改善比較

## 改善前のフロー
フロー1: 画像の読み込み
- Normal画像とShape画像のペアを関連付け
- 各カテゴリ（NG/OK）ごとに画像を整理
- 画像の基本情報（サイズ、形式）を確認

フロー2: ワーク接合部の位置判定
- テンプレートマッチングで左右判定
- テンプレート画像との類似度を計算
- 左右どちらかを判断

フロー3: 接合部の切り離し
- 左右判定に基づき切り取り位置を決定
- 画像から接合部を切り離し
- 必要な領域のみを保持

フロー4: マスク生成と前処理
- 二値化で基本的なマスクを作成
- ノイズ除去のためのオープン処理
- エッジをつなぐためのクローズ処理
- 検査対象領域の特定

## 改善後のフロー
フロー1: 画像の読み込み
- Normal画像とShape画像のペアを関連付け
- 各カテゴリ（NG/OK）ごとに画像を整理
- 画像の基本情報（サイズ、形式）を確認

フロー2: 特徴点（円）の検出
- Hough変換による円の検出
- 複数の円の中心座標を特定
- 検出された円の大きさを計算

フロー3: テンプレートと撮影画像の位置合わせ
- スケール（拡大率）の最適化
- 位置のずれ量を計算
- テンプレートの変形パラメータを決定
- 画像間の位置を合わせる

フロー4: 加工領域の特定
- テンプレートの白黒反転
- テンプレートを撮影画像に合わせて変形
- 加工領域のマスクを生成
- 検査対象領域の特定

この改善により：
1. より正確な検査領域の特定が可能に
2. 画像の位置ずれに柔軟に対応
3. テンプレートの特徴を活かした領域抽出
4. 自動的な位置合わせによる安定性向上
