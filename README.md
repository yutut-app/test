# CannyとDoGの組み合わせによる欠陥検出フロー

## フロー1: 前処理
- 入力画像のノイズを除去（ガウシアンフィルタ適用）し、検出精度を向上
- 画像の輝度を正規化し、明るさの違いによる影響を軽減
- 二値化マスクを作成し、検査対象領域を特定

## フロー2: フィルタ処理（Canny/DoG並列処理）
### Cannyエッジ検出
- Sobelフィルタで画像の勾配（エッジの強さと方向）を計算
- エッジを細線化（非最大値抑制）し、明確な輪郭を抽出
- 大きな鋳巣の輪郭を検出

### DoGフィルタ処理
- 異なる強さ（σ1=1.5, σ2=3.5など）のガウシアンフィルタをかけ差分を計算
- 複数スケールのDoG結果を統合し、様々なサイズの特徴を検出
- 小さな鋳巣の特徴を検出

## フロー3: 閾値処理
- Cannyでは2段階の閾値処理で確実なエッジを抽出
- DoGでは輝度ベースとコントラスト比による閾値処理で欠陥候補を抽出
- 両手法の結果を統合し、相補的な欠陥検出を実現

## フロー4: 欠陥候補領域の切り出し
- 近接した検出領域をマージして一つの欠陥候補として統合
- 検査対象領域外の検出結果を除外（マスク適用）
- サイズや形状に基づいて最終的な欠陥候補を決定

このフローにより、大きな鋳巣はCannyで、小さな鋳巣はDoGで効果的に検出し、両者の利点を活かした総合的な欠陥検出が可能になります。
